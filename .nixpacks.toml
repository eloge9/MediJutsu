# .nixpacks.toml

[phases.setup]
# Packages système nécessaires pour WeasyPrint et Flask
packages = [
    "python310",             # Python (choisir la version que tu utilises)
    "cairo",
    "pango",
    "gdk-pixbuf",
    "gobject-introspection",
    "libffi",
    "glib",
    "fontconfig",
    "libxml2",
    "libxslt",
    "freetype",
    "harfbuzz"
]

[phases.install]
# Supprime le cache pip pour éviter les conflits
pre = "rm -rf /root/.cache/pip"

[phases.build]
# Crée l'environnement virtuel et installe les dépendances Python
run = '''
python -m venv /opt/venv
. /opt/venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
'''

[phases.start]
# Commande pour lancer ton app Flask
run = '''
. /opt/venv/bin/activate
gunicorn app:app -b 0.0.0.0:8080
'''
